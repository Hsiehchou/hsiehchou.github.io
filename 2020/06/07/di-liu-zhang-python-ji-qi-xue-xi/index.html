<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Python, 机器学习">
    <meta name="description" content="深度学习、强化学习,Python,Matlab,R,Java的自己实践中的经验">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="baidu-site-verification" content="2VN5bX64Cz" />
    <title>第六章 Python机器学习 | 谢舟的博客</title>
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/favicon.png">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/css/matery.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/css/my.css">

    <script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/jquery/jquery.min.js"></script>
    
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="谢舟的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
					<div>
						
						<img src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/medias/logo.png" class="logo-img" alt="LOGO">
						
						<span class="logo-span">谢舟的博客</span>
					</div>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">谢舟的博客</div>
        <div class="logo-desc">
            
            深度学习、强化学习,Python,Matlab,R,Java的自己实践中的经验
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
    </ul>
</div>

        </div>

        
    </nav>

</header>

    
<script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/medias/featureimages/21.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">第六章 Python机器学习</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Python/">
                                <span class="chip bg-color">Python</span>
                            </a>
                        
                            <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
                                <span class="chip bg-color">机器学习</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" class="post-category">
                                机器学习
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-06-07
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    8.8k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    33 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>

        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="第六章-Python-机器学习"><a href="#第六章-Python-机器学习" class="headerlink" title="第六章 Python 机器学习"></a>第六章 Python 机器学习</h2><h3 id="1、机器学习基础"><a href="#1、机器学习基础" class="headerlink" title="1、机器学习基础"></a>1、机器学习基础</h3><h4 id="1-1-机器学习分类"><a href="#1-1-机器学习分类" class="headerlink" title="1.1 机器学习分类"></a>1.1 机器学习分类</h4><h5 id="1-1-1-机器学习定义"><a href="#1-1-1-机器学习定义" class="headerlink" title="1.1.1 机器学习定义"></a>1.1.1 机器学习定义</h5><ol>
<li>机器学习 (Machine Learning, ML) 是一门综合性非常强的多领域<code>交叉学科</code>，涉及线性代数、概率论、统计学、算法复杂度理论等多门学科。</li>
<li>机器学习根据已知<code>数据</code>来不断<code>学习和积累经验</code>，然后<code>总结出规律并尝试预测未知数据的属性</code>。机器学习可利用数据或经验等不断<code>改善自身的性能</code>。</li>
<li>机器学习是目前<code>弱人工智能</code>的核心，其应用十分广泛，如计算机视觉、自然语言处理、生物特征识别、搜索引擎、垃圾邮件过滤、推荐系统、广告投放、信用评价、欺诈检测、股票交易和医疗诊断等应用。</li>
</ol>
<h5 id="1-1-2-机器学习分类"><a href="#1-1-2-机器学习分类" class="headerlink" title="1.1.2 机器学习分类"></a>1.1.2 机器学习分类</h5><ol>
<li><p>可以定义为：机器学习是从<code>数据</code>中自动分析获得<code>模型</code>，并利用模型对未知数据进行<code>预测</code>。可分为：</p>
</li>
<li><p>监督学习（supervised learning）<br>1）监督学习：主要特点是要在训练模型时提供给学习系统<code>训练样本以及样本对应的类别标签</code>，因此又称为有导师学习。例：学生从老师那里获取知识、信息，老师提供对错指示、告知最终答案的学习过程。<br>2）典型的监督学习方法：决策树、支持向量机（SVM）、监督式神经网络等分类算法和线性回归等回归算法。<br>3）监督学习目标：利用一组带有<code>标签</code>的数据，学习从<code>输入到输出的映射</code>，然后将这种映射关系<code>应用到未知数据</code>上，达到分类（输出是<code>离散</code>的）或回归（输出是<code>连续</code>的）的目的。<br>4）监督学习（supervised learning）<br>•    目标值：类别——分类问题。<br>•    目标值：连续型的数据——回归问题。<br>5）示例<br>➢    预测明天的气温是多少度？<br>➢    预测明天天气是晴、阴或雨？<br>➢    人的年龄预测？<br>➢    人脸识别？</p>
</li>
<li><p>无监督学习（unsupervised learning）<br>1）无监督学习：主要特点是训练时<code>只提供</code>给学习系统<code>训练样本</code>，而没有样本对应的类别标签信息。例：没有老师的情况下，学生从书本或网络自学的过程。<br>2）无监督学习中，训练数据包含一组输入向量而<code>没有相应的目标值</code>。这类算法的目标可能是发现原始数据中<code>相似样本的组合（称作聚类）</code>，或者确定<code>数据的分布（称作密度估计）</code>，或者把数据从高维空间投影到低维空间（称作<code>降维</code>）以便进行可视化。<br>3）典型的无监督学习方法：聚类学习、自组织神经网络学习。</p>
</li>
<li><p>半监督学习（semi-supervised learning）<br>1）半监督学习方式下，训练数据有<code>部分被标识</code>，<code>部分没有被标识</code>，这种模型首先需要学习数据的内在结构，以便合理的组织数据来进行预测。算法上，包括一些对常用监督式学习算法的延伸，这些算法首先试图<code>对未标识数据进行建模</code>，在此基础上<code>再对标识的数据进行预测</code>。<br>2）例：给学生很多未分类的书本与少量的清单，清单上说明哪些书属于同一类别，要求对其他所有书本进行分类。</p>
</li>
<li><p>强化学习（reinforcement learning，增强学习）<br>1）强化学习：主要特点是通过试错来发现最优行为策略而不是带有标签的样本学习。<br>2）主要包含四个元素，agent，环境状态，行动，奖励, 强化学习的目标就是获得最多的累计奖励。<br>3）例：小孩学走路、下棋 （包括下围棋和象棋）、机器人、自动驾驶等。</p>
</li>
</ol>
<h4 id="1-2-监督学习-分类"><a href="#1-2-监督学习-分类" class="headerlink" title="1.2 监督学习-分类"></a>1.2 监督学习-分类</h4><h5 id="1-2-1-分类学习"><a href="#1-2-1-分类学习" class="headerlink" title="1.2.1 分类学习"></a>1.2.1 分类学习</h5><ol>
<li><p>输入：一组有<code>标签</code>的训练数据(也称观察和评估)，标签表明了这些数据（观察）的所署类别。</p>
</li>
<li><p>输出：分类模型根据这些训练数据，训练自己的<code>模型参数</code>，学习出一个适合这组数据的<code>分类器</code>，当有新数据（非训练数据）需要进行类别判断，就可以将这组新数据作为输入送给学习好的分类器进行判断。</p>
</li>
<li><p>数据集<br>1）训练集(training set):顾名思义用来训练模型的<code>已标注数据</code>，用来建立模型，发现规律。<br>2）测试集(testing set):也是<code>已标注数据</code>，通常做法是将<code>标注隐藏</code>，输送给训练好的模型，通过结果与真实标注进行对比，<code>评估模型</code>的学习能力。</p>
</li>
<li><p>训练集/测试集划分方法<br>根据已有标注数据，随机选出一部分数据（70%）作为训练数据，余下的作为测试数据，此外还有交叉验证法等用来评估分类模型。</p>
</li>
<li><p>分类学习评价标准<br>1）精确率：针对预测结果而言，也称查全率，是所有样本中<code>被识别为A类</code>的样本数量与<code>实际属于A类</code>的样本数量的比值。以二分类为例，它表示的是<code>预测为正</code>的样本中有多少是<code>真正的正</code>样本。那么就有两种可能：一种就是把正类预测为正类(TP)，另一种就是把负类预测为正类(FP)。精确率P=TP/(TP+FP)<br>2）召回率：针对原样本而言，它表示的是样本中的正例有多少被预测正确。那也有两种可能：一种是把原来的正类预测成正类(TP)，另一种就是把原来的正类预测为负类(TN)。召回率P=TP/(TP+TN)</p>
</li>
<li><p>分类学习评价标准——例：<br>•    假设我们手上有60个正样本，40个负样本，我们要找出所有的正样本。<br>•    TP: 将正类预测为正类数40；TN: 将正类预测为负类数20；FP: 将负类预测为正类数10；FN: 将负类预测为负类数30。<br>•    准确率（accuracy）=预测对的/所有=(TP+FN)/(TP+FN+FP+TN)=(40+30)/100=70%<br>•    精确率（precision）=TP/(TP+FP)=40/(40+10)=80%<br>•    召回率（recall）=TP/(TP+TN)=40/(40+20)=66.7%</p>
</li>
<li><p>分类学习应用<br>•    金融：贷款是否批准进行评估。<br>•    医疗诊断：判断一个肿瘤是恶性还是良性。<br>•    欺诈检测：判断一笔银行的交易是否涉嫌欺诈。<br>•    网页分类：判断网页的所属类别，财经或者是娱乐？<br>•    垃圾邮件分类：判定邮件是否为垃圾邮件。</p>
</li>
</ol>
<h5 id="1-2-2-分类学习常用算法"><a href="#1-2-2-分类学习常用算法" class="headerlink" title="1.2.2 分类学习常用算法"></a>1.2.2 分类学习常用算法</h5><ol>
<li><p>K近邻分类器(KNN)<br>KNN：通过计算待分类数据点，与已有数据集中的所有数据点的距离。取距离最小的前K个点，根据“少数服从多数“的原则，将这个数据点划分为出现次数最多的那个类别。<br><img src="/medias/1591458262946.png" alt="K近邻分类器(KNN)"></p>
</li>
<li><p>决策树<br>1）决策树是一种树形结构的分类器，通过顺序询问分类点的属性决定分类点最终的类别。<br>2）通常根据特征的信息增益或其他指标，构建一颗决策树。<br>3）在分类时，只需要按照决策树中的结点依次进行判断，即可得到样本所属类别。<br><img src="/medias/1591458315138.png" alt="判定是否去相亲的决策树"></p>
</li>
<li><p>朴素贝叶斯<br>1）朴素贝叶斯分类器是一个以贝叶斯定理为基础的多分类的分类器。<br>2）对于给出的待分类项，求解在此项出现的条件下各个类别出现的概率，哪个最大，就认为此待分类项属于哪个类别。<br>$$P(A|B)=\frac{P(B|A)P(A)}{P(B)}$$</p>
</li>
</ol>
<h4 id="1-3-监督学习-回归分析"><a href="#1-3-监督学习-回归分析" class="headerlink" title="1.3 监督学习-回归分析"></a>1.3 监督学习-回归分析</h4><h5 id="1-3-1-回归分析"><a href="#1-3-1-回归分析" class="headerlink" title="1.3.1 回归分析"></a>1.3.1 回归分析</h5><ol>
<li><p>回归：统计学分析数据的方法，目的在于了解两个或多个<code>变数间是否相关</code>、研究其<code>相关方向与强度</code>，并建立<code>数学模型</code>以便<code>观察特定变数</code>来<code>预测</code>研究者感兴趣的<code>变数</code>。</p>
</li>
<li><p>回归分析可以帮助人们了解在<code>自变量变化时因变量的变化量</code>。一般来说，通过回归分析我们可以由给出的自变量估计因变量的条件期望。</p>
</li>
<li><p>回归分析应用：回归方法适合对一些带有时序信息的数据进行预测或者趋势拟合，常用在金融及其他涉及时间序列分析的领域：<br>1）股票趋势预测<br>2）交通流量预测<br>3）房价预测</p>
</li>
</ol>
<h5 id="1-3-2-回归分析方法"><a href="#1-3-2-回归分析方法" class="headerlink" title="1.3.2 回归分析方法"></a>1.3.2 回归分析方法</h5><ol>
<li>线性回归<br>线性回归 (Linear Regression) 是利用数理统计中回归分析，来确定两种或两种以上变量间相互依赖的定量关系的一种统计分析方法，其使用形如 y=wx+b 的<code>线性模型</code>拟合数据输入和输出之间的映射关系。</li>
</ol>
<p><img src="/medias/1591458735099.png" alt="线性回归"></p>
<ol start="2">
<li><p>线性回归——实际用途<br>1）利用数据拟合<code>模型进行预测</code>：如果目标是预测或者映射，线性回归可以用来对观测数据集的 y 和 X 的值拟合出一个预测模型。当完成这样一个模型以后，对于一个新增的 X 值，在没有给定与它相配对的 y 的情况下，可以用这个拟合过的模型预测出一个 y 值。<br>2）相关性分析<code>去除冗余</code>：给定一个变量 y 和一些变量 $X_1-X_n$，这些变量有可能与 y 相关，线性回归分析可以用来量化 y 与 $X_i$  之间相关性的强度，评估出与 y 不相关的 $X_i$ ，并识别出哪些 $X_i$ 的子集包含了关于 y 的冗余信息。</p>
</li>
<li><p>房价与房屋尺寸关系的线性拟合<br>1）背景：我们可以根据已知的房屋成交价和房屋的尺寸进行线性回归，继而可以对已知房屋尺寸，而未知房屋成交价格的实例进行成交价格的预测。<br>2）目标：对房屋成交信息建立回归方程，并依据回归方程对房屋价格进行预测。</p>
<p><img src="/medias/1591458884615.png" alt="房价与房屋尺寸关系的线性拟合图"></p>
</li>
<li><p>非线性拟合：多项式回归<br>1）多项式回归(Polynomial Regression)是研究一个因变量与一个或多个自变量间多项式的回归分析方法。<br>2）如果自变量只有一个时，称为一元多项式回归；如果自变量有多个时，称为多元多项式回归。</p>
</li>
<li><p>什么时候用多项式回归<br>1）在一元回归分析中，如果依变量 y 与自变量 x 的关系为<code>非线性的</code>，但是又找不到适当的函数曲线来拟合，则可以采用一元多项式回归。<br>2）多项式回归的最大优点就是可以<code>通过增加x的高次项对实测点进行逼近</code>，直至满意为止。<br>3）事实上，多项式回归可以处理相当一类非线性问题，它在回归分析中占有重要的地位，因为任一函数都可以分段用多项式来逼近。</p>
</li>
</ol>
<h3 id="2、Scikit-learn-库"><a href="#2、Scikit-learn-库" class="headerlink" title="2、Scikit-learn 库"></a>2、Scikit-learn 库</h3><h4 id="2-1-Sklearn-库概述"><a href="#2-1-Sklearn-库概述" class="headerlink" title="2.1 Sklearn 库概述"></a>2.1 Sklearn 库概述</h4><h5 id="2-1-1-Scikit-learn-库概述"><a href="#2-1-1-Scikit-learn-库概述" class="headerlink" title="2.1.1 Scikit-learn 库概述"></a>2.1.1 Scikit-learn 库概述</h5><ol>
<li>Scikit-learn 项目最早由数据科学家 David Cournapeau 在2007年发起，使用需要 NumPy 和 SciPy 等其他库的支持，是 Python 中专门针对机器学习应用而发展起来的一款开源扩展库。</li>
<li>和其他众多的开源项目一样，Scikit-learn 目前主要由社区成员自发进行维护。</li>
<li>Scikit-learn 相比其他开源项目显得更为保守，主要体现在：一是Scikit-learn 从来不做除机器学习领域之外的其他扩展，二是 Scikit-learn 从来不采用未经广泛验证的算法。</li>
<li><a href="http://scikit-learn.org/stable/index.html" target="_blank" rel="noopener">http://scikit-learn.org/stable/index.html</a></li>
</ol>
<p><img src="/medias/1591459169266.png" alt="Scikit-learn 库"></p>
<h5 id="2-1-2-Scikit-learn-库数据集"><a href="#2-1-2-Scikit-learn-库数据集" class="headerlink" title="2.1.2 Scikit-learn 库数据集"></a>2.1.2 Scikit-learn 库数据集</h5><p>在机器学习中，经常需要使用各种各样的数据集，Scikit-learn 库提供了一些常用的数据集：</p>
<table>
<thead>
<tr>
<th align="left">序号</th>
<th align="left">数据集名称</th>
<th align="left">调研方式</th>
<th align="left">数据描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">鸢尾花数据集</td>
<td align="left">Load_iris()</td>
<td align="left">用于多分类任务的数据集</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">波士顿房价数据集</td>
<td align="left">Load_boston()</td>
<td align="left">用于回归任务的经典数据集</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">糖尿病数据集</td>
<td align="left">Load_diabetes()</td>
<td align="left">用于回归任务的经典数据集</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">手写数字数据集</td>
<td align="left">Load_digits()</td>
<td align="left">用于多分类任务的数据集</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">乳腺癌数据集</td>
<td align="left">Load_breast_cancer()</td>
<td align="left">经典的用于二分类任务的数据集</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">体能训练数据集</td>
<td align="left">Load_linnerud()</td>
<td align="left">经典的用于多变量回归任务的数据集</td>
</tr>
</tbody></table>
<h5 id="2-1-3-Scikit-learn-库功能"><a href="#2-1-3-Scikit-learn-库功能" class="headerlink" title="2.1.3 Scikit-learn 库功能"></a>2.1.3 Scikit-learn 库功能</h5><ol>
<li><p>分类<br>1）分类是指识别给定对象的所属类别，属于监督学习的范畴，最常见的应用场景包括垃圾邮件检测和图像识别等。<br>2）目前 Scikit-learn 已经实现的算法包括：支持向量机（SVM），最近邻，逻辑回归，随机森林，决策树以及多层感知器（MLP）神经网络等。</p>
</li>
<li><p>回归<br>1）回归是指预测与给定对象相关联的连续值属性，最常见的应用场景包括预测药物反应和预测股票价格等。<br>2）目前 Scikit-learn 已经实现的算法包括：支持向量回归(SVR)，脊回归，Lasso 回归，弹性网络（Elastic Net），最小角回归（LARS），贝叶斯回归，以及各种不同的鲁棒回归算法等。<br>3）回归算法几乎涵盖了所有开发者的需求范围，而且更重要的是，Scikit-learn 还针对每种算法都提供了简单明了的用例参考。</p>
</li>
<li><p>聚类<br>1）聚类是指自动识别具有相似属性的给定对象，并将其分组为集合，属于无监督学习的范畴。<br>2）最常见的应用场景包括顾客细分和试验结果分组。目前 Scikit-learn 已经实现的算法包括：K-均值聚类，谱聚类，均值偏移，分层聚类，DBSCAN 聚类等。</p>
</li>
<li><p>数据降维<br>数据降维是指使用主成分分析（PCA）、非负矩阵分解（NMF）或特征选择等降维技术来减少要考虑的随机变量的个数，其主要应用场景包括可视化处理和效率提升。</p>
</li>
<li><p>模型选择<br>模型选择是指对于给定参数和模型的比较、验证和选择，其主要目的是通过参数调整来提升精度。目前 Scikitlearn 实现的模块包括：格点搜索，交叉验证和各种针对预测误差评估的度量函数。</p>
</li>
<li><p>数据预处理<br>1）数据预处理是指数据的特征提取和归一化，是机器学习过程中的第一个也是最重要的一个环节。<br>2）归一化是指将输入数据转换为具有零均值和单位权方差的新变量，但因为大多数时候都做不到精确等于零，因此会设置一个可接受的范围，一般都要求落在 0-1 之间。<br>3）特征提取是指将文本或图像数据转换为可用于机器学习的数字变量。</p>
</li>
</ol>
<p><img src="/medias/1591459683330.png" alt="Scikit-learn 库功能"></p>
<h4 id="2-2-Sklearn-库分类算法"><a href="#2-2-Sklearn-库分类算法" class="headerlink" title="2.2 Sklearn 库分类算法"></a>2.2 Sklearn 库分类算法</h4><h5 id="2-2-1-Scikit-learn-库分类算法"><a href="#2-2-1-Scikit-learn-库分类算法" class="headerlink" title="2.2.1 Scikit-learn 库分类算法"></a>2.2.1 Scikit-learn 库分类算法</h5><ol>
<li>K近邻分类器(KNN)<br>KNN：通过计算待分类数据点，与已有数据集中的所有数据点的距离。取距离最小的前 K 个点，根据“少数服从多数“的原则，将这个数据点划分为出现次数最多的那个类别。</li>
</ol>
<p><strong>K近邻算法</strong></p>
<p> <img src="/medias/1591459969667.png" alt="K近邻分类器(KNN)"></p>
<ol start="2">
<li>Sklearn 中的 k 邻分类器<br>在 sklearn 库中，可以使用 sklearn.neighbors.KNeighborsClassifier 创建一个 K 近邻分类器，主要参数有：<br>1）n_neighbors：用于指定分类器中K的大小(默认值为5)。<br>2）Weights：设置选中的K个点对分类结果影响的权重（默认值为平均权重”uniform”，可以选择“distance”代表越近的点权重越高，或者传入自己编写的以距离为参数的权重计算函数）。<br>3）algorithm：设置用于计算临近点的方法 （ 选项中有ball_tree、kd_tree 和 brute，分别代表不同的寻找邻居的优化算法，默认值为 auto，根据训练数据自动选择）。<br> <strong>k值的选择</strong><br>①    如果 k 值较小，就相当于用较小邻域中的训练实例进行预测，极端情况下 k=1，测试实例只和最接近的一个样本有关，训练误差很小(0)，但是如果这个样本恰好是噪声，预测就会出错。也就是说，如果k值过小，容易产生过拟合，误差过大。<br>②    如果 k 值较大，就相当于用很大邻域中的训练实例进行预测，相当于和估计数据不相近的样本也参与了，造成模型偏差过大。极端情况是 k=n，测试实例的结果是训练数据集中实例最多的类，这样会产生欠拟合。<br>③    在应用中，一般选择较小 k 并且 k 是奇数。通常采用交叉验证的方法来选取合适的 k 值，或者 k 一般低于训练样本数的平方根。<br> <strong>Sklearn 中的 k 邻分类器——示例</strong></li>
</ol>
<pre><code>from sklearn.neighbors import KNeighborsClassifier

# 创建一组数据X和它对应的标签y
X=[[0],[1],[2],[3],[4],[5]]
y=[0,0,0,1,1,1]

# 使用最近的3个邻居作为分类的依据，得到分类器
neigh = KNeighborsClassifier(n_neighbors=3)

# 将训练数据 X 和标签 y 送入分类器进行学习
neigh.fit(X, y)

# 调用 predict() 函数，对未知分类样本 [1.1]分类，可以直接并将需要分类的数据构造为数组形式作为参数传入，得到分类标签作为返回值
print(neigh.predict([[1.4]]))
print(neigh.predict([[2.4]]))
print(neigh.predict([[2.5]]))
print(neigh.predict([[2.6]]))</code></pre><p><strong>运行结果</strong><br>[0]<br>[0]<br>[0]<br>[1]</p>
<ol start="3">
<li><p>决策树<br>1）决策树是一种树形结构的分类器，通过顺序询问分类点的属性决定分类点最终的类别。<br>2）通常根据特征的信息增益或其他指标，构建一颗决策树。<br>3）在分类时，只需要按照决策树中的结点依次进行判断，即可得到样本所属类别。</p>
<p><img src="/medias/1591460354838.png" alt="判定是否去相亲的决策树"><br><strong>Sklearn中的决策树</strong><br>在 sklearn 库中 ， 可以使用sklearn.tree.DecisionTreeClassifier 创建一个决策树用于分类，其主要参数有：<br>1）criterion ：用于选择属性的准则，可以传入 “gini” 代表基尼系数，或者 “entropy”  代表信息增益。<br>2）max_features ：表示在决策树结点进行分裂时，从多少个特征中选择最优特征。可以设定固定数目、百分比或其他标准，默认值是所有特征个数。</p>
</li>
</ol>
<p><strong>Sklearn中的决策树算法示例</strong></p>
<pre><code>from sklearn import datasets # 导入方法类

iris = datasets.load_iris() # 加载 iris 数据集
iris_feature = iris.data # 特征数据
iris_target = iris.target # 分类数据
from sklearn.model_selection import train_test_split
feature_train, feature_test, target_train, target_test = train_test_split(iris_feature, iris_target, test_size=0.33, random_state=42)

from sklearn.tree import DecisionTreeClassifier

dt_model = DecisionTreeClassifier() # 所以参数均置为默认状态
dt_model.fit(feature_train,target_train) # 使用训练集训练模型
predict_results = dt_model.predict(feature_test) # 使用模型对测试集进行预测

print(&#39;predict_results:&#39;, predict_results)
print(&#39;target_test:&#39;, target_test)


# 通过scikit-learn中提供的评估计算方法查看预测结果的准确度
from sklearn.metrics import accuracy_score

print(accuracy_score(predict_results, target_test))</code></pre><p><strong>运行结果</strong></p>
<p>predict_results: [1 0 2 1 1 0 1 2 2 1 2 0 0 0 0 1 2 1 1 2 0 2 0 2 2 2 2 2 0 0 0 0 1 0 0 2 1<br> 0 0 0 2 1 1 0 0 1 1 2 1 2]<br>target_test: [1 0 2 1 1 0 1 2 1 1 2 0 0 0 0 1 2 1 1 2 0 2 0 2 2 2 2 2 0 0 0 0 1 0 0 2 1<br> 0 0 0 2 1 1 0 0 1 2 2 1 2]<br>0.96</p>
<ol start="4">
<li>Sklearn 中的朴素贝叶斯<br>•    在 sklearn 库中，实现了三个朴素贝叶斯分类器，如下表所示</li>
</ol>
<table>
<thead>
<tr>
<th align="left">分类器</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">naive_bayes.GussianNB</td>
<td align="left">高斯朴素贝叶斯</td>
</tr>
<tr>
<td align="left">naive_bayes.MultinomialNB</td>
<td align="left">针对多项式模型的斯朴素贝叶斯分类器</td>
</tr>
<tr>
<td align="left">naive_bayes.BernoulliNB</td>
<td align="left">针对多元伯努利模型的斯朴素贝叶斯分类器</td>
</tr>
</tbody></table>
<p>区别在于假设某一特征的所有属于某个类别的观测值符合特定分布，如，分类问题的特征包括人的身高，身高符合高斯分布，这类问题适合高斯朴素贝叶斯</p>
<p><strong>Sklearn中的朴素贝叶斯算法示例</strong></p>
<pre><code>import numpy as np
from sklearn.naive_bayes import GaussianNB

X = np.array([[-1, -1], [-2, -1], [-3, -2], [1, 1], [2, 1], [3, 2]])
Y = np.array([1, 1, 1, 2, 2, 2])
#使用默认参数，创建一个高斯朴素贝叶斯分类器，并将该分类器赋给变量
clf = GaussianNB(priors=None)
clf.fit(X, Y)
print(clf.predict([[-0.8, -1]]))</code></pre><p><strong>运行结果</strong><br>[1]</p>
<h4 id="2-3-Sklearn-库回归算法"><a href="#2-3-Sklearn-库回归算法" class="headerlink" title="2.3 Sklearn 库回归算法"></a>2.3 Sklearn 库回归算法</h4><h5 id="2-3-1-Scikit-learn-库回归算法"><a href="#2-3-1-Scikit-learn-库回归算法" class="headerlink" title="2.3.1 Scikit-learn 库回归算法"></a>2.3.1 Scikit-learn 库回归算法</h5><ol>
<li><p>Sklearn 中的回归算法<br>•    线性回归函数包括：普通线性回归函数（LinearRegression），岭回归（Ridge）， Lasso回归（Lasso）。<br>•    非线性回归函数，如多项式回归（Polynomial Features）通过<br>sklearn.preprocessing 子模块进行调用</p>
</li>
<li><p>Sklearn 中的线性回归：房价与房屋尺寸线性拟合<br>•    技术路线：sklearn.linear_model.LinearRegression<br>•    调用 sklearn.linear_model.LinearRegression() 所需参数：<br>1）fit_intercept : 布尔型参数，表示是否计算该模型截距。可选参数；<br>2）normalize : 布尔型参数，若为 True，则X在回归前进行归一化。可选参数。默认值为 False；<br>3）copy_X : 布尔型参数，若为True，则X将被复制；否则将被覆盖。 可选参数。默认值为 True；<br>4）n_jobs : 整型参数，表示用于计算的作业数量；若为 -1，则用所有的 CPU。可选参数。默认值为 1；</p>
</li>
</ol>
<h5 id="2-3-2-Sklearn中的线性回归：房价与房屋尺寸线性拟合"><a href="#2-3-2-Sklearn中的线性回归：房价与房屋尺寸线性拟合" class="headerlink" title="2.3.2 Sklearn中的线性回归：房价与房屋尺寸线性拟合"></a>2.3.2 Sklearn中的线性回归：房价与房屋尺寸线性拟合</h5><pre><code>import matplotlib.pyplot as plt
import numpy as np
from sklearn import linear_model

# 读取数据集
datasets_X = []#房屋面积
datasets_Y = []#房屋价格
fr = open(&#39;prices.txt&#39;,&#39;r&#39;) 
lines = fr.readlines()
for line in lines:
    items = line.strip().split(&#39;,&#39;)
    datasets_X.append(int(items[0])) # 注意加上类型转换
    datasets_Y.append(int(items[1]))

# 将 datasets_X 转换为二维数组，以符合 linear.fit 函数的参数要求
datasets_X = np.array(datasets_X).reshape([-1,1])
datasets_Y = np.array(datasets_Y)

# 以数据datasets_X的最大值和最小值为范围，建立等差数列，方便后续画图。 
minX = min(datasets_X)
maxX = max(datasets_X)
X = np.arange(minX,maxX).reshape([-1,1])

linear = linear_model.LinearRegression() 
linear.fit(datasets_X, datasets_Y)

# 图像中显示
plt.scatter(datasets_X, datasets_Y, color = &#39;red&#39;,label=&#39;origin data&#39;)
plt.plot(X, linear.predict(X), color = &#39;blue&#39;,label=&#39;linear regression prediction&#39;) 
plt.legend()  #使label生效
plt.xlabel(&#39;Area&#39;)
plt.ylabel(&#39;Price&#39;)
plt.show()</code></pre><h3 id="3、线性回归预测实战"><a href="#3、线性回归预测实战" class="headerlink" title="3、线性回归预测实战"></a>3、线性回归预测实战</h3><h4 id="3-1-线性回归原理"><a href="#3-1-线性回归原理" class="headerlink" title="3.1 线性回归原理"></a>3.1 线性回归原理</h4><h5 id="3-1-1-“回归”的由来"><a href="#3-1-1-“回归”的由来" class="headerlink" title="3.1.1 “回归”的由来"></a>3.1.1 “回归”的由来</h5><ol>
<li><p>“回归” 是由高尔顿在研究人类遗传问题时提出来的。</p>
</li>
<li><p>为研究父代与子代身高的关系，高尔顿搜集了 1078 对父亲及其儿子的身高数据并进行了深入分析，发现了回归效应:</p>
</li>
<li><p>当父亲高于平均身高时，他们的儿子身高比他更高的概率要小于比他更矮的概率；父亲矮于平均身高时，他们的儿子身高比他更矮的概率要小于比他更高的概率。</p>
</li>
<li><p>即这两种身高父亲的儿子的身高，有向他们父辈的平均身高回归的趋势，解释为：大自然约束使人类身高分布相对稳定而非两极分化，就是所谓的“回归效应”。</p>
</li>
</ol>
<h5 id="3-1-2-回归分析概念"><a href="#3-1-2-回归分析概念" class="headerlink" title="3.1.2 回归分析概念"></a>3.1.2 回归分析概念</h5><ol>
<li>回归分析法：指将具有相关关系的两个变量之间的数量关系进行测定，通过建立一个数学表达式进行统计估计和预测的统计研究方法。</li>
<li>自变量：一般把作为估测依据的变量叫做自变量</li>
<li>因变量： 待估测的变量</li>
<li>回归方程：反映自变量和因变量之间联系的数学表达式</li>
<li>回归模型：某一类回归方程的总称</li>
</ol>
<h5 id="3-1-3-回归分析步骤"><a href="#3-1-3-回归分析步骤" class="headerlink" title="3.1.3 回归分析步骤"></a>3.1.3 回归分析步骤</h5><p><img src="/medias/1591461605573.png" alt="回归分析步骤"></p>
<h4 id="3-2-线性回归模型原理"><a href="#3-2-线性回归模型原理" class="headerlink" title="3.2 线性回归模型原理"></a>3.2 线性回归模型原理</h4><p><img src="/medias/1591461655296.png" alt="线性回归模型"><br><img src="/medias/1591461668594.png" alt="线性回归模型"><br><img src="/medias/1591461678967.png" alt="线性回归模型"></p>
<h4 id="3-3-预测儿童身高实战"><a href="#3-3-预测儿童身高实战" class="headerlink" title="3.3 预测儿童身高实战"></a>3.3 预测儿童身高实战</h4><h5 id="3-3-1-线性回归预测实战"><a href="#3-3-1-线性回归预测实战" class="headerlink" title="3.3.1 线性回归预测实战"></a>3.3.1 线性回归预测实战</h5><ol>
<li><p>线性回归预测儿童身高<br>•    假定一个人的身高只受年龄、性别、父母身高、祖父母身高和外祖父母身高这几个因素的影响，并假定大致符合线性关系。<br>•    在其他条件不变的情况下，随着年龄的增长，会越来越高；<br>•    同样，对于其他条件都相同的儿童，其父母身高较高的话，儿童也会略高一些。<br>•    假定到18岁后身高会长期保持固定而不再变化（不考虑年龄太大之后会稍微变矮一点的情况）。<br>•    根据给定<code>训练数据和对应标签</code>，线性拟合出儿童身高模型，预测测试数据儿童身高。</p>
</li>
<li><p>线性回归预测儿童身高<br>•    训练数据：每行表示一个样本，包含信息为：儿童年龄，性别（0女1田）、父亲、母亲、祖父、祖母、外祖父、和外祖母的身高。<br>[[1, 0, 180, 165, 175, 165, 170, 165],<br>[3, 0, 180, 165, 175, 165, 173, 165],<br>[4, 0, 180, 165, 175, 165, 170, 165],<br>[6, 0, 180, 165, 175, 165, 170, 165],<br>[8, 1, 180, 165, 175, 167, 170, 165],<br>[10, 0, 180, 166, 175, 165, 170, 165],<br>[11, 0, 180, 165, 175, 165, 170, 165],<br>[12, 0, 180, 165, 175, 165, 170, 165],<br>[13, 1, 180, 165, 175, 165, 170, 165],<br>[14, 0, 180, 165, 175, 165, 170, 165],<br>[17, 0, 170, 165, 175, 165, 170, 165]]<br>• 对应标签数据：儿童身高<br>[60, 90, 100, 110, 130, 140, 150, 164, 160, 163, 168]</p>
</li>
<li><p>线性回归预测儿童身高<br>1）导入扩展库</p>
</li>
</ol>
<pre><code>import copy
import numpy as np
from sklearn import linear_model</code></pre><p>2）训练数据准备</p>
<pre><code>x = np.array([[1, 0, 180, 165, 175, 165, 170, 165],[3, 0, 180, 165, 175, 165, 173, 165],[4, 0, 180, 165, 175, 165, 170, 165],[6, 0, 180, 165, 175, 165, 170, 165],[8, 1, 180, 165, 175, 167, 170, 165],[10, 0, 180, 166, 175, 165, 170, 165],[11, 0, 180, 165, 175, 165, 170, 165],[12, 0, 180, 165, 175, 165, 170, 165],[13, 1, 180, 165, 175, 165, 170, 165],[14, 0, 180, 165, 175, 165, 170, 165],[17, 0, 170, 165, 175, 165, 170, 165]])

y = np.array([60, 90, 100, 110, 130, 140, 150, 164, 160, 163, 168])</code></pre><p>3）创建线性回归模型，得出拟合直线</p>
<pre><code># 创建线性回归模型
lr = linear_model.LinearRegression() 

# 根据已知数据拟合最佳直线
lr.fit(x, y)</code></pre><p>4）待预测数据准备</p>
<pre><code>xs = np.array([[10, 0, 180, 165, 175, 165, 170, 165],[17, 1, 173, 153, 175, 161, 170, 161],[34, 0, 170, 165, 170, 165, 170, 165]])</code></pre><p>5）预测并输出结果</p>
<pre><code>for item in xs:
    # 为不改变原始数据，进行深复制，并假设超过18岁以后就不再长高了
    # 对于18岁以后的年龄，返回18岁时的身高
    item1 = copy.deepcopy(item)
    if item1[0] &gt; 18:
        item1[0] = 18
    print(item, &#39;:&#39;, lr.predict(item1.reshape(1,-1)))</code></pre><p><strong>运行结果</strong><br>[ 10   0 180 165 175 165 170 165] : [140.56153846]<br>[ 17   1 173 153 175 161 170 161] : [158.41]<br>[ 34   0 170 165 170 165 170 165] : [176.03076923]</p>
<h3 id="4、贝叶斯分类实战"><a href="#4、贝叶斯分类实战" class="headerlink" title="4、贝叶斯分类实战"></a>4、贝叶斯分类实战</h3><h4 id="4-1-分类基本概念"><a href="#4-1-分类基本概念" class="headerlink" title="4.1 分类基本概念"></a>4.1 分类基本概念</h4><h5 id="4-1-1-什么是分类"><a href="#4-1-1-什么是分类" class="headerlink" title="4.1.1 什么是分类"></a>4.1.1 什么是分类</h5><p><strong>超市物品分类</strong></p>
<p><img src="/medias/1591462398944.png" alt="超市物品分类"></p>
<p><strong>垃圾分类</strong></p>
<p><img src="/medias/1591462403300.png" alt="垃圾分类"></p>
<p><strong>生活信息分类</strong></p>
<p><img src="/medias/1591462408292.png" alt="生活信息分类"></p>
<h5 id="4-1-2-分类在数据挖掘中的定义"><a href="#4-1-2-分类在数据挖掘中的定义" class="headerlink" title="4.1.2 分类在数据挖掘中的定义"></a>4.1.2 分类在数据挖掘中的定义</h5><p>•    分类就是把一些新的数据项<code>映射到给定类别</code>的中的某一个类别。<br>•    分类属于<code>有监督学习</code>(supervised learning)，与之相对于的是无监督学习<br>(unsupervised learning)，比如聚类。<br>•    分类与聚类的最大区别在于，分类数据中的一部分的<code>类别是已知</code>的，而聚类数据的<code>类别未知</code>。</p>
<h5 id="4-1-3-分类问题"><a href="#4-1-3-分类问题" class="headerlink" title="4.1.3 分类问题"></a>4.1.3 分类问题</h5><p><strong>动物分类问题</strong><br>根据现有的知识，我们得到了一些关于哺乳动物和鸟类的信息，我们能否对新发现的物种，比如动物A，动物B进行分类？</p>
<table>
<thead>
<tr>
<th align="left">动物种类</th>
<th align="left">体型</th>
<th align="left">翅膀数量</th>
<th align="left">脚的只数</th>
<th align="left">是否产蛋</th>
<th align="left">是否有毛</th>
<th align="left">类别</th>
</tr>
</thead>
<tbody><tr>
<td align="left">狗</td>
<td align="left">中</td>
<td align="left">0</td>
<td align="left">4</td>
<td align="left">否</td>
<td align="left">是</td>
<td align="left">哺乳动物</td>
</tr>
<tr>
<td align="left">猪</td>
<td align="left">大</td>
<td align="left">0</td>
<td align="left">4</td>
<td align="left">否</td>
<td align="left">是</td>
<td align="left">哺乳动物</td>
</tr>
<tr>
<td align="left">牛</td>
<td align="left">大</td>
<td align="left">0</td>
<td align="left">4</td>
<td align="left">否</td>
<td align="left">是</td>
<td align="left">哺乳动物</td>
</tr>
<tr>
<td align="left">麻雀</td>
<td align="left">小</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">是</td>
<td align="left">是</td>
<td align="left">鸟类</td>
</tr>
<tr>
<td align="left">天鹅</td>
<td align="left">中</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">是</td>
<td align="left">是</td>
<td align="left">鸟类</td>
</tr>
<tr>
<td align="left">大雁</td>
<td align="left">中</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">是</td>
<td align="left">是</td>
<td align="left">鸟类</td>
</tr>
<tr>
<td align="left">动物A</td>
<td align="left">大</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">是</td>
<td align="left">无</td>
<td align="left">?</td>
</tr>
<tr>
<td align="left">动物B</td>
<td align="left">中</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">否</td>
<td align="left">是</td>
<td align="left">?</td>
</tr>
</tbody></table>
<h5 id="4-1-4-分类的流程"><a href="#4-1-4-分类的流程" class="headerlink" title="4.1.4 分类的流程"></a>4.1.4 分类的流程</h5><ol>
<li>步骤一：将样本转化为等维的数据特征（<code>特征提取</code>）。所有样本必须具有相同数量的特征。兼顾特征的全面性和独立性。</li>
<li>步骤二：选择与类别相关的特征（<code>特征选择</code>）。比如，绿色代表与类别非常相关，黑色代表部分相关，浅蓝色代表完全无关。</li>
<li>步骤三：建立分类模型或分类器。</li>
<li>分类器通常可以看作一个函数，它把特征映射到类的空间上。</li>
<li>$$f(x_{i1},  x_{i2}, x_{i3}, …,x_{in})→y_i$$</li>
</ol>
<table>
<thead>
<tr>
<th align="left">动物种类</th>
<th align="left">体型</th>
<th align="left">翅膀数量</th>
<th align="left">脚的只数</th>
<th align="left">是否产蛋</th>
<th align="left">是否有毛</th>
<th align="left">类别</th>
</tr>
</thead>
<tbody><tr>
<td align="left">狗</td>
<td align="left">中</td>
<td align="left">0</td>
<td align="left">4</td>
<td align="left">否</td>
<td align="left">是</td>
<td align="left">哺乳动物</td>
</tr>
<tr>
<td align="left">猪</td>
<td align="left">大</td>
<td align="left">0</td>
<td align="left">4</td>
<td align="left">否</td>
<td align="left">是</td>
<td align="left">哺乳动物</td>
</tr>
<tr>
<td align="left">牛</td>
<td align="left">大</td>
<td align="left">0</td>
<td align="left">4</td>
<td align="left">否</td>
<td align="left">是</td>
<td align="left">哺乳动物</td>
</tr>
<tr>
<td align="left">麻雀</td>
<td align="left">小</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">是</td>
<td align="left">是</td>
<td align="left">鸟类</td>
</tr>
<tr>
<td align="left">天鹅</td>
<td align="left">中</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">是</td>
<td align="left">是</td>
<td align="left">鸟类</td>
</tr>
<tr>
<td align="left">大雁</td>
<td align="left">中</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">是</td>
<td align="left">是</td>
<td align="left">鸟类</td>
</tr>
</tbody></table>
<h5 id="4-1-5-分类的方法"><a href="#4-1-5-分类的方法" class="headerlink" title="4.1.5 分类的方法"></a>4.1.5 分类的方法</h5><p>1）常用分类算法主要包括相似函数，关联规则分类算法，K近邻分类算法，决策树分类算法，贝叶斯分类算法和基于模糊逻辑，遗传算法，粗糙集和神经网络的分类算法。<br>2）分类算法有很多种，都有各自的优缺点和应用范围，本课程我们以贝叶斯分类算法为例。</p>
<h4 id="4-2-贝叶斯分类概述"><a href="#4-2-贝叶斯分类概述" class="headerlink" title="4.2 贝叶斯分类概述"></a>4.2 贝叶斯分类概述</h4><ol>
<li><p>背景<br>1）贝叶斯分类基于<code>贝叶斯</code>定理，贝叶斯定理是由 18 世纪概率论和决策论的研究者 Thomas Bayes 发明的，故用其名字命名为贝叶斯定理。<br>2）通过对分类算法的比较研究发现，朴素贝叶斯分类法可以与决策树和经过挑选的神经网络分类器相媲美。用于大型数据库，贝叶斯分类法也具有很高准确率和速度。</p>
</li>
<li><p>先验概率与后验概率<br>1）先验概率：由<code>以往</code>的数据分析得到的概率；<br>2）后验概率：<code>得到信息之后</code>重新加以修正的概率。</p>
</li>
<li><p>贝叶斯理论<br>1）简单的说，<code>贝叶斯定理是基于假设的先验概率</code>、给定假设下观察到不同数据的概率，提供了一种计算后验概率的方法。<br>2）在人工智能领域，贝叶斯方法是一种非常具有代表性的<code>不确定性知识表示和推理方法</code>。</p>
</li>
<li><p>贝叶斯定理<br>1）P(A)  是 A 的<code>先验概率或边缘概率</code>。之所以称为“先验”是因为它不考虑任何B方面的因素。<br>2）P(A|B) 是已知 B 发生后 A 的<code>条件概率</code>，也由于得自 B 的取值而被称作 A 的<code>后验概率</code>。<br>3）P(B|A ) 是已知 A 发生后 B 的<code>条件概率</code>，也由于得自 A 的取值而被称作B的<code>后验概率</code>。<br>4）P(B)是B的<code>先验概率或边缘概率</code>，也作标准化常量（normalized constant）。<br>$$P(A|B)=P(A)\frac{P(B|A)}{P(B)}$$<br>贝叶斯公式提供了从先验概率 P(A)、P(B) 和 P(B|A) 计算后验概率 P(A|B) 的方法。</p>
</li>
<li><p>朴素贝叶斯<br>假设待分类项的各个属性相互独立的情况下构造的分类算法就是朴素贝叶斯算法。</p>
</li>
</ol>
<p><strong>基本思想</strong><br>给定的待分类项 X{a1,a2，…,an}，求解在此项出现条件下各个类别 $y_i$ 出现的概率，哪个 P($y_i$|X) 最大，就把此待分类项归属哪个类别。</p>
<ol start="6">
<li>四种贝叶斯分类器<br>1）Naïve Bayes：朴素贝叶斯，假定各特征变量 x 是相互独立的。<br>2）TAN：对朴素贝叶斯进行了扩展，允许各特征变量所对应的节点构成一棵树。<br>3）BAN：对 TAN 扩展，允许各特征变量所对应的节点间关系构成一个图，而不止是树。<br>4）GBN：一种无约束的贝叶斯网络分类器。</li>
</ol>
<p><img src="/medias/1591463598040.png" alt="四种贝叶斯分类器"></p>
<ol start="7">
<li><p>贝叶斯分类流程<br>1）准备阶段：主要是依据具体情况<code>确定特征属性</code>，并且对特征属性进行适当划分。然后就是对一部分待分类项进行人工划分，以确定训练样本。<code>输入是所有的待分类项，输出是特征属性和训练样本</code>。<br>2）分类器训练阶段：计算每个类别在训练样本中出现频率以及每个特征属性划分对每个类别的条件概率估计。<code>输入是特征属性和训练样本，输出是分类器</code>。<br>3）应用阶段：使用分类器对待分类项进行分类，其<code>输入是分类器和待分类项，输出是待分类项与类别的映射关系</code>。</p>
<p><img src="/medias/1591463645577.png" alt="贝叶斯分类流程"></p>
</li>
</ol>
<h4 id="4-3-垃圾邮件分类实战"><a href="#4-3-垃圾邮件分类实战" class="headerlink" title="4.3 垃圾邮件分类实战"></a>4.3 垃圾邮件分类实战</h4><p>训练数据：<br>垃圾邮件（0.txt至150.txt），其中 0-127 为垃圾邮件，128 至 150 为正常邮件，151 至 156 为测试邮件。</p>
<p><img src="/medias/1591463717009.png" alt="垃圾邮件分类"></p>
<h5 id="4-3-1-问题分析"><a href="#4-3-1-问题分析" class="headerlink" title="4.3.1 问题分析"></a>4.3.1 问题分析</h5><p>①    读取全部训练集，<code>删除其中的干扰字符</code>，例如【】*。、，等等，然后<code>分词</code>，再删除<code>长度为 1</code>的单个字，这样的单个字对于文本分类没有贡献，剩下的词汇认为是有效词汇。</p>
<p>②    统计全部训练集中每个<code>有效词汇的出现次数</code>，截取出现次数最多的<code>前N个</code>。</p>
<p>③    根据第 1 步预处理后的垃圾邮件和非垃圾邮件内容生成特征向量，统计第 2 步中得到的N个词语分别在该邮件中的出现频率。</p>
<p>④    根据第 3 步中得到特征向量和已知邮件分类创建并训练朴素贝叶斯模型。</p>
<p>⑤    读取测试邮件，参考第 1 步，对邮件文本进行预处理，提取特征向量。</p>
<p>⑥    使用第 4 步中训练好的模型，根据第 5 步提取的特征向量对邮件进行分类。</p>
<h5 id="4-3-2-垃圾邮件分类实战"><a href="#4-3-2-垃圾邮件分类实战" class="headerlink" title="4.3.2 垃圾邮件分类实战"></a>4.3.2 垃圾邮件分类实战</h5><ol>
<li>导入扩展库</li>
</ol>
<pre><code>from re import sub
from collections import Counter 
from itertools import chain
from numpy import array
from jieba import cut
from sklearn.naive_bayes import MultinomialNB</code></pre><ol start="2">
<li>获取文件中所有词</li>
</ol>
<pre><code>def getWordsFromFile(txtFile):
    words = []
    with open(txtFile, encoding=&#39;utf8&#39;) as fp:
        for line in fp:
            line = line.strip()
            line = sub(r&#39;[.【】0-9、—。，！~\*]&#39;, &#39;&#39;, line) 
            line = cut(line)
            line = filter(lambda word: len(word)&gt;1, line)
            words.extend(line)
    return words</code></pre><ol start="3">
<li>获得全部训练集中出现次数最多的词</li>
</ol>
<pre><code>allWords = []
def getTopNWords(topN):
    txtFiles = [str(i)+&#39;.txt&#39; for i in range(151)]
    for txtFile in txtFiles:
        allWords.append(getWordsFromFile(txtFile)) 
    freq = Counter(chain(*allWords))
    return [w[0] for w in freq.most_common(topN)]

topWords = getTopNWords(600)</code></pre><ol start="4">
<li>获取特征向量、创建模型训练</li>
</ol>
<pre><code>vectors = []
for words in allWords:
    temp = list(map(lambda x: words.count(x), topWords))
    vectors.append(temp) 

vectors = array(vectors) 
labels = array([1]*127 + [0]*24)

model = MultinomialNB() 
model.fit(vectors, labels)</code></pre><ol start="5">
<li>预测未知邮件，进行分类，看是否为垃圾邮件</li>
</ol>
<pre><code>def predict(txtFile):
    words = getWordsFromFile(txtFile)
    currentVector = array(tuple(map(lambda x: words.count(x),topWords)))
    result = model.predict(currentVector.reshape(1, -1))[0] 
    return &#39;垃圾邮件&#39; if result==1 else &#39;正常邮件&#39;

for mail in (&#39;%d.txt&#39;%i for i in range(151, 156)):
    print(mail, predict(mail), sep=&#39;:&#39;)</code></pre>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://blog.hsiehchou.com" rel="external nofollow noreferrer">谢舟</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://blog.hsiehchou.com/2020/06/07/di-liu-zhang-python-ji-qi-xue-xi/">https://blog.hsiehchou.com/2020/06/07/di-liu-zhang-python-ji-qi-xue-xi/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://blog.hsiehchou.com" target="_blank">谢舟</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Python/">
                                    <span class="chip bg-color">Python</span>
                                </a>
                            
                                <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
                                    <span class="chip bg-color">机器学习</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2020/06/19/matlab-xue-xi/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/medias/featureimages/19.jpg" class="responsive-img" alt="MATLAB 学习">
                        
                        <span class="card-title">MATLAB 学习</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            第一章 MATLAB 介绍MATLAB(矩阵实验室的简称）是一种专业的计算机程序，用于工程科学的矩阵数学运算。但在以后的几年内，它逐渐发展为一种极其灵活的计算体系，用于解决各种重要的技术问题。
1.1 MATLAB 的优点
易用性
平台独立
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-06-19
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Matlab/" class="post-category">
                                    Matlab
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Matlab/">
                        <span class="chip bg-color">Matlab</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/06/06/di-wu-zhang-python-shu-ju-ke-shi-hua/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/medias/featureimages/13.jpg" class="responsive-img" alt="第五章 Python 数据可视化">
                        
                        <span class="card-title">第五章 Python 数据可视化</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            第五章 Python 数据可视化1、Matplotlib 基础1.1 Matplotlib 库介绍
Matplotlib 是 Python 最著名的绘图库，它提供了一整套和 Matlab 相似的命令 API，十分适合交互式地进行制图。而且也
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-06-06
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Python/" class="post-category">
                                    Python
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python/">
                        <span class="chip bg-color">Python</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('60')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 谢舟的博客<br />'
            + '文章作者: 谢舟<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4, h5'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\(', '\)']]}
    });
</script>


    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019-2020</span>
            <a href="https://blog.hsiehchou.com" target="_blank">谢舟</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">492.5k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            
			<br>
            
            <span id="icp"><img src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备17042062号 苏公网安备 32062102000231号</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:babbyxie@foxmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=417952939" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 417952939" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/materialize/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/aos/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/js/matery.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>


    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?1fdd6e11866c1fe7b815d69a4a4206ea";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    
    
    
    <script src="https://cdn.jsdelivr.net/gh/hsiehchou/hsiehchou.github.io/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
